-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONNECTION
-----------------------------------------------------------------------------------------------------------------------------------------
vSERVER = Tunnel.getInterface("warehouse")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIABLES
-----------------------------------------------------------------------------------------------------------------------------------------
local Warehouse = ""
-----------------------------------------------------------------------------------------------------------------------------------------
-- LIST
-----------------------------------------------------------------------------------------------------------------------------------------
local List = {
	["1"] = vec3(-73.05,-1197.07,27.65),
	["2"] = vec3(-78.8,-1204.19,27.63),
	["3"] = vec3(-67.14,-1199.43,27.79),
	["4"] = vec3(-71.1,-1206.31,27.87),
	["5"] = vec3(-61.5,-1205.12,28.16),
	["6"] = vec3(-65.9,-1211.59,28.36),
	["7"] = vec3(-56.28,-1210.31,28.48),
	["8"] = vec3(-52.93,-1216.41,28.7),
	["9"] = vec3(-56.65,-1229.2,28.8),
	["10"] = vec3(-66.42,-1226.43,28.83),
	["11"] = vec3(-60.77,-1233.61,28.9),
	["12"] = vec3(-72.5,-1233.9,29.08),
	["13"] = vec3(-66.22,-1239.45,29.03),
	["14"] = vec3(-73.67,-1243.05,29.1),
	["15"] = vec3(-43.99,-1235.59,29.34),
	["16"] = vec3(-43.97,-1241.86,29.34),
	["17"] = vec3(-43.97,-1252.53,29.25),
	["18"] = vec3(-173.96,-1266.26,32.59),
	["19"] = vec3(-193.71,-1284.31,31.31),
	["20"] = vec3(-193.7,-1290.26,31.29),
	["21"] = vec3(-152.18,-1302.92,31.29),
	["22"] = vec3(903.16,3586.15,33.43),
	["23"] = vec3(914.68,3562.7,33.8),
	["24"] = vec3(914.67,3567.38,33.78),
	["25"] = vec3(433.69,3573.16,33.23),
	["26"] = vec3(379.46,3583.39,33.3),
	["27"] = vec3(186.06,2786.62,46.02),
	["28"] = vec3(642.07,2791.8,41.97),
	["29"] = vec3(619.1,2784.49,43.47),
	["30"] = vec3(588.48,2782.29,43.47),
	["31"] = vec3(583.27,2781.96,43.47),
	["32"] = vec3(1695.71,6430.87,32.71),
	["33"] = vec3(178.69,6392.1,32.37),
	["34"] = vec3(175.19,6398.75,32.37),
	["35"] = vec3(147.0,6366.74,31.53),
	["36"] = vec3(108.89,6326.23,31.37),
	["37"] = vec3(96.49,6329.04,31.37),
	["38"] = vec3(93.55,6335.0,31.37),
	["39"] = vec3(-246.59,6068.58,32.33)
}
-----------------------------------------------------------------------------------------------------------------------------------------
-- THREADSTART
-----------------------------------------------------------------------------------------------------------------------------------------
CreateThread(function()
	for Index,v in pairs(List) do
		exports["target"]:AddCircleZone("Warehouse:"..Index,v,3.0,{
			name = "Warehouse:"..Index,
			heading = 3374176
		},{
			shop = Index,
			Distance = 1.5,
			options = {
				{
					event = "warehouse:Open",
					label = "Abrir",
					tunnel = "shop"
				},{
					event = "warehouse:Upgrade",
					label = "Aumentar",
					tunnel = "server"
				},{
					event = "warehouse:Password",
					label = "Trocar Senha",
					tunnel = "server"
				}
			}
		})
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- WAREHOUSE:OPEN
-----------------------------------------------------------------------------------------------------------------------------------------
AddEventHandler("warehouse:Open",function(Number)
	if LocalPlayer["state"]["Route"] < 900000 then
		if not exports["hud"]:Wanted() and vSERVER.Warehouse(Number) then
			Warehouse = Number
			SetNuiFocus(true,true)
			SendNUIMessage({ action = "showMenu" })
		end
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CLOSE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Close",function(Data,Callback)
	SendNUIMessage({ action = "hideMenu" })
	SetNuiFocus(false,false)
	Warehouse = ""

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- TAKE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Take",function(Data,Callback)
	vSERVER.Take(Data["item"],Data["slot"],Data["amount"],Data["target"],Warehouse)

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- STORE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Store",function(Data,Callback)
	vSERVER.Store(Data["item"],Data["slot"],Data["amount"],Data["target"],Warehouse)

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- UPDATE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Update",function(Data,Callback)
	vSERVER.Update(Data["slot"],Data["target"],Data["amount"],Warehouse)

	Callback("Ok")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- REQUEST
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Request",function(Data,Callback)
	local Inventory,Warehouse,invPeso,invMaxpeso,warehousePeso,warehouseMaxpeso = vSERVER.openWarehouse(Warehouse)
	if Inventory then
		Callback({ myInventory = Inventory, myWarehouse = Warehouse, invPeso = invPeso, invMaxpeso = invMaxpeso, warehousePeso = warehousePeso, warehouseMaxpeso = warehouseMaxpeso })
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- WAREHOUSE:UPDATE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent("warehouse:Update")
AddEventHandler("warehouse:Update",function(Action)
	SendNUIMessage({ action = Action })
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- WAREHOUSE:WEIGHT
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent("warehouse:Weight")
AddEventHandler("warehouse:Weight",function(invPeso,invMaxpeso,warehousePeso,warehouseMaxpeso)
	SendNUIMessage({ action = "updateWeight", invPeso = invPeso, invMaxpeso = invMaxpeso, warehousePeso = warehousePeso, warehouseMaxpeso = warehouseMaxpeso })
end)